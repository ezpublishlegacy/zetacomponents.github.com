<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html 
	xmlns="http://www.w3.org/1999/xhtml"
	xml:lang="en"
	lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

	<meta name="description" content="Zeta Components - reusable set of high quality PHP components to fasten your development." />
	<meta name="keywords" content="PHP, apache, components, framework, quality" />
	<meta name="author" content="dotxp" />
	<meta name="language" content="en" />
	<meta name="date" content="Wed, 04 Aug 2010 13:07:09 +0200" />
	<meta name="robots" content="all" />

	<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
	<meta name="DC.title" content="Tutorial" />
	<meta name="DC.creator" content="dotxp" />
	<meta name="DC.date" content="Wed, 04 Aug 2010 13:07:09 +0200" />
	<meta name="DC.rights" content="Copyright" />

	<link rel="meta" href="/documentation/trunk/ImageConversion/tutorial.rdf" />
	<link rel="icon" href="/images/favicon.png" type="image/png" />

	<link rel="Stylesheet" type="text/css" href="/styles/screen.css" media="screen" />
	<link rel="Stylesheet" type="text/css" href="/styles/print.css" media="print" />


	<title>Zeta Components - high quality PHP components</title>
</head>
<body>
<div id="wcv">
	<h1>
		<a id="header-png" href="" title="Zeta Components - high quality PHP components">
			Zeta Components - high quality PHP components
		</a>
	</h1>

	<ul class="navigation">
<li >
	<a href="/news.html" title="About">About</a>
	</li>
<li >
	<a href="/community/index.html" title="Community">Community</a>
	</li>
<li class="requested">
	<a href="/documentation/overview.html" title="Documentation">Documentation</a>
	</li>
<li >
	<a href="/download/index.html" title="Download">Download</a>
	</li>
<li >
	<a href="/support.html" title="Support">Support</a>
	</li>

</ul>
<ul class="subnavigation">
<li >
	<a href="/documentation/overview.html" title="Overview">Overview</a>
	</li>
<li >
	<a href="/documentation/install.html" title="Installation">Installation</a>
	</li>

</ul>

	<div class="content">
    <ul class="tabs">
    <li class="requested">
	<a href="/documentation/trunk/ImageConversion/tutorial.html" title="Tutorial">Tutorial</a>
	</li>
<li >
	<a href="/documentation/trunk/ImageConversion/phpdoc/classtrees.html" title="API">API</a>
	</li>

</ul>

		<h2>eZ Components - ImageConversion</h2><div class="toc"><h3>Table of Contents</h3><ul><li><p><a href="#introduction">Introduction</a></p></li><li><p><a href="#class-overview">Class overview</a></p></li><li><p><a href="#usage">Usage</a></p><ul><li><p><a href="#converting-mime-types">Converting MIME types</a></p></li><li><p><a href="#simple-filtering">Simple filtering</a></p></li><li><p><a href="#complex-transformations">Complex transformations</a></p></li><li><p><a href="#adding-watermarks">Adding watermarks</a></p></li><li><p><a href="#creating-thumbnails">Creating thumbnails</a></p></li></ul></li><li><p><a href="#troubleshooting">Troubleshooting</a></p><ul><li><p><a href="#corrupt-jpeg-files">Corrupt JPEG files</a></p></li></ul></li></ul></div><a name="introduction"></a><a name="id1"></a><h3>Introduction</h3><p>The ImageConversion component provides image manipulation tools. It enables you to perform filter actions (such as scaling, changing the colorspace, adding a swirl effect) and to convert between different MIME image types. Filters and conversions are grouped as "transformations", which can be globally configured and accessed from anywhere in the application. Conversions and filters can be performed through different handlers (currently supported are PHP's GD extension and the external ImageMagick program). ImageConversion is capable of automatically selecting an appropriate handler. You can also set handler priorities.</p><a name="class-overview"></a><a name="id2"></a><h3>Class overview</h3><p>This section gives you an overview of the main classes.</p><dl><dt>ezcImageConverter</dt><dd>This is the main class that collects all transformations, communicates with the handlers and applies filters and conversions.</dd><dt>ezcImageFilter</dt><dd>This class is used to represent the configuration of a filter.</dd><dt>ezcImageTransformation</dt><dd>A transformation can contain any number of filters. It also specifies which output MIME types are acceptable for the transformation.</dd></dl><a name="usage"></a><a name="id3"></a><h3>Usage</h3><a name="converting-mime-types"></a><a name="id4"></a><h4>Converting MIME types</h4><p>The following example creates a very simple transformation to convert any other image type into JPEG:</p><ol class="code">
<li><span style="color: #000000">&lt;?php</span></li>
<li></li>
<li><span style="color: #0000FF">require_once&nbsp;</span><span style="color: #335533">'tutorial_autoload.php'</span><span style="color: #0000FF">;</span></li>
<li></li>
<li><span style="color: #000000">$tutorialPath&nbsp;</span><span style="color: #0000FF">=&nbsp;</span><span style="color: #000000">dirname</span><span style="color: #0000FF">(&nbsp;</span><span style="color: #000000">__FILE__&nbsp;</span><span style="color: #0000FF">);</span></li>
<li></li>
<li><span style="color: #000000">$settings&nbsp;</span><span style="color: #0000FF">=&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageConverterSettings.html'>ezcImageConverterSettings</a></span><span style="color: #0000FF">(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;array(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageHandlerSettings.html'>ezcImageHandlerSettings</a></span><span style="color: #0000FF">(&nbsp;</span><span style="color: #335533">'GD'</span><span style="color: #0000FF">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'<a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageGdHandler.html'>ezcImageGdHandler</a>'&nbsp;</span><span style="color: #0000FF">),</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageHandlerSettings.html'>ezcImageHandlerSettings</a></span><span style="color: #0000FF">(&nbsp;</span><span style="color: #335533">'ImageMagick'</span><span style="color: #0000FF">,&nbsp;</span><span style="color: #335533">'<a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageImagemagickHandler.html'>ezcImageImagemagickHandler</a>'&nbsp;</span><span style="color: #0000FF">),</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;)</span></li>
<li><span style="color: #0000FF">);</span></li>
<li></li>
<li><span style="color: #000000">$converter&nbsp;</span><span style="color: #0000FF">=&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageConverter.html'>ezcImageConverter</a></span><span style="color: #0000FF">(&nbsp;</span><span style="color: #000000">$settings&nbsp;</span><span style="color: #0000FF">);</span></li>
<li></li>
<li><span style="color: #000000">$converter</span><span style="color: #0000FF">-&gt;</span><span style="color: #000000">createTransformation</span><span style="color: #0000FF">(&nbsp;</span><span style="color: #335533">'jpeg'</span><span style="color: #0000FF">,&nbsp;array(),&nbsp;array(&nbsp;</span><span style="color: #335533">'image/jpeg'&nbsp;</span><span style="color: #0000FF">)&nbsp;);</span></li>
<li></li>
<li><span style="color: #0000FF">try</span></li>
<li><span style="color: #0000FF">{</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">$converter</span><span style="color: #0000FF">-&gt;</span><span style="color: #000000">transform</span><span style="color: #0000FF">(&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'jpeg'</span><span style="color: #0000FF">,&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">$tutorialPath</span><span style="color: #0000FF">.</span><span style="color: #335533">'/img/imageconversion_example_01_before.bmp'</span><span style="color: #0000FF">,&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">$tutorialPath</span><span style="color: #0000FF">.</span><span style="color: #335533">'/img/imageconversion_example_01_after.jpg'&nbsp;</span></li>
<li><span style="color: #335533">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF">);</span></li>
<li><span style="color: #0000FF">}</span></li>
<li><span style="color: #0000FF">catch&nbsp;(&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageTransformationException.html'>ezcImageTransformationException</a>&nbsp;$e</span><span style="color: #0000FF">)</span></li>
<li><span style="color: #0000FF">{</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;die(&nbsp;</span><span style="color: #335533">"Error&nbsp;transforming&nbsp;the&nbsp;image:&nbsp;&lt;</span><span style="color: #0000FF">{</span><span style="color: #000000">$e</span><span style="color: #0000FF">-&gt;</span><span style="color: #000000">getMessage</span><span style="color: #0000FF">()}</span><span style="color: #335533">&gt;"&nbsp;</span><span style="color: #0000FF">);</span></li>
<li><span style="color: #0000FF">}</span></li>
<li></li>
<li></li>
<li><span style="color: #000000">?&gt;</span></li>

</ol><p>First, the settings for <a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageConverter.html'>ezcImageConverter</a> are defined (lines 7 to 12) using <a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageConverterSettings.html'>ezcImageConverterSettings</a>. Whenever <a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageConverter.html'>ezcImageConverter</a> is instantiated, it needs to know which handlers are available. The order in the <a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageHandlerSettings.html'>ezcImageHandlerSettings</a> array defines the priority of the handlers. In this case, <a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageConverter.html'>ezcImageConverter</a> will check if a given filter or conversion can be performed by the GD handler. If not, it will check the ImageMagick handler. On line 14, <a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageConverter.html'>ezcImageConverter</a> is instantiated using the defined settings.</p><p>Line 16 shows how a transformation is created. The first parameter to <a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageConverter.html#createTransformation'>ezcImageConverter::createTransformation</a>() defines the name of the transformation, while the second parameter would usually contain filters (which are not used here). Instead, just one output MIME type is defined as the third parameter. As a result, this transformation returns images of the type "image/jpeg".</p><p>On lines 21 to 24, the transformation is applied. The first parameter to <a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageConverter.html#transform'>ezcImageConverter::transform</a>() contains the name of the transformation to apply. The second one specifies the file to transform, while the third one specifies the desired output filename. Aside from exceptions of the type <a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcBaseFileException.html'>ezcBaseFileException</a>, the <a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageTransformation.html#transform'>ezcImageTransformation::transform</a>() method can only throw exceptions of the type <a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageTransformationException.html'>ezcImageTransformationException</a>, which we catch here to print out an error message.</p><p>The input and output images are shown below:</p><table><tbody><tr><td><p class="cell"><img alt="Original BMP (92k)." title="Original BMP (92k)." src="img/imageconversion_example_01_before.bmp"/></p></td><td><p class="cell"><img alt="Converted JPEG (24k)." title="Converted JPEG (24k)." src="img/imageconversion_example_01_after.jpg"/></p></td></tr><tr><td><p class="cell">BMP version (92k)</p></td><td><p class="cell">Converted JPEG (24k)</p></td></tr></tbody></table><a name="simple-filtering"></a><a name="id5"></a><h4>Simple filtering</h4><p>The next example shows a transformation that, in addition to the converting to JPEG, uses a filter to scale images:</p><ol class="code">
<li><span style="color: #000000">&lt;?php</span></li>
<li></li>
<li><span style="color: #0000FF">require_once&nbsp;</span><span style="color: #335533">'tutorial_autoload.php'</span><span style="color: #0000FF">;</span></li>
<li></li>
<li><span style="color: #000000">$tutorialPath&nbsp;</span><span style="color: #0000FF">=&nbsp;</span><span style="color: #000000">dirname</span><span style="color: #0000FF">(&nbsp;</span><span style="color: #000000">__FILE__&nbsp;</span><span style="color: #0000FF">);</span></li>
<li></li>
<li><span style="color: #000000">$settings&nbsp;</span><span style="color: #0000FF">=&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageConverterSettings.html'>ezcImageConverterSettings</a></span><span style="color: #0000FF">(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;array(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageHandlerSettings.html'>ezcImageHandlerSettings</a></span><span style="color: #0000FF">(&nbsp;</span><span style="color: #335533">'GD'</span><span style="color: #0000FF">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'<a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageGdHandler.html'>ezcImageGdHandler</a>'&nbsp;</span><span style="color: #0000FF">),</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageHandlerSettings.html'>ezcImageHandlerSettings</a></span><span style="color: #0000FF">(&nbsp;</span><span style="color: #335533">'ImageMagick'</span><span style="color: #0000FF">,&nbsp;</span><span style="color: #335533">'<a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageImagemagickHandler.html'>ezcImageImagemagickHandler</a>'&nbsp;</span><span style="color: #0000FF">),</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;)</span></li>
<li><span style="color: #0000FF">);</span></li>
<li></li>
<li><span style="color: #000000">$converter&nbsp;</span><span style="color: #0000FF">=&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageConverter.html'>ezcImageConverter</a></span><span style="color: #0000FF">(&nbsp;</span><span style="color: #000000">$settings&nbsp;</span><span style="color: #0000FF">);</span></li>
<li></li>
<li><span style="color: #000000">$filters&nbsp;</span><span style="color: #0000FF">=&nbsp;array(&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageFilter.html'>ezcImageFilter</a></span><span style="color: #0000FF">(&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'scale'</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'width'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;</span><span style="color: #000000">320</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'height'&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;</span><span style="color: #000000">240</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'direction'&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageGeometryFilters.html#constSCALE_DOWN'>ezcImageGeometryFilters::SCALE_DOWN</a></span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;),</span></li>
<li><span style="color: #0000FF">);</span></li>
<li></li>
<li><span style="color: #000000">$converter</span><span style="color: #0000FF">-&gt;</span><span style="color: #000000">createTransformation</span><span style="color: #0000FF">(&nbsp;</span><span style="color: #335533">'preview'</span><span style="color: #0000FF">,&nbsp;</span><span style="color: #000000">$filters</span><span style="color: #0000FF">,&nbsp;array(&nbsp;</span><span style="color: #335533">'image/jpeg'&nbsp;</span><span style="color: #0000FF">)&nbsp;);</span></li>
<li></li>
<li><span style="color: #0000FF">try</span></li>
<li><span style="color: #0000FF">{</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">$converter</span><span style="color: #0000FF">-&gt;</span><span style="color: #000000">transform</span><span style="color: #0000FF">(&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'preview'</span><span style="color: #0000FF">,&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">$tutorialPath</span><span style="color: #0000FF">.</span><span style="color: #335533">'/img/imageconversion_example_02_before.jpg'</span><span style="color: #0000FF">,&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">$tutorialPath</span><span style="color: #0000FF">.</span><span style="color: #335533">'/img/imageconversion_example_02_after.jpg'&nbsp;</span></li>
<li><span style="color: #335533">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF">);</span></li>
<li><span style="color: #0000FF">}</span></li>
<li><span style="color: #0000FF">catch&nbsp;(&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageTransformationException.html'>ezcImageTransformationException</a>&nbsp;$e</span><span style="color: #0000FF">)</span></li>
<li><span style="color: #0000FF">{</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;die(&nbsp;</span><span style="color: #335533">"Error&nbsp;transforming&nbsp;the&nbsp;image:&nbsp;&lt;</span><span style="color: #0000FF">{</span><span style="color: #000000">$e</span><span style="color: #0000FF">-&gt;</span><span style="color: #000000">getMessage</span><span style="color: #0000FF">()}</span><span style="color: #335533">&gt;"&nbsp;</span><span style="color: #0000FF">);</span></li>
<li><span style="color: #0000FF">}</span></li>
<li></li>
<li><span style="color: #000000">?&gt;</span></li>

</ol><p>After instantiating <a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageConverter.html'>ezcImageConverter</a>, we define the filters to apply. We apply only one filter in this example. Each filter definition must be an instance of <a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageFilter.html'>ezcImageFilter</a>. The first parameter to the constructor of <a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageFilter.html'>ezcImageFilter</a> (<a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageFilter.html#__construct'>ezcImageFilter::__construct</a>()) is the name of the filter to use. The second parameter is an array of settings for the filter. The filter name must correspond to a method name for one of the filter interfaces:</p><ul><li><p>ezcImageGeometryFilters</p></li><li><p>ezcImageColorspaceFilters</p></li><li><p>ezcImageEffectFilters</p></li></ul><p>The settings array must contain all parameters that the specific filter method expects and the array keys must correspond to the names of the parameters. For example, the scale filter used here is defined in <a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageGeometryFilters.html#scale'>ezcImageGeometryFilters::scale</a>(). The available image handlers support the following filters:</p><ul><li><p>ezcImageGdFilters</p></li></ul><blockquote/><ul><li><p>ezcImageImagemagickFilters</p></li></ul><blockquote/><p>The filter definition shown here makes <a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageConverter.html'>ezcImageConverter</a> scale images to a box of 320x240 pixels. Images will only be scaled if they are larger than the given size, but not if they are already smaller or fit exactly.</p><p>The rest of the example is pretty much the same as example 1. To keep the example images web-friendly, we use a JPEG image as the source file here:</p><a name="original-image-450x246"></a><h5>Original image (450x246)</h5><div class="&#10;&#9;&#9;&#9;&#9;&#9;image &#10;&#9;&#9;&#9;&#9;&#9;&#10;&#9;&#9;&#9;&#9;&#9;&#9;&#9;center&#10;&#9;&#9;&#9;&#9;&#9;&#9; "><img alt="Original JPEG image." title="Original JPEG image." src="img/imageconversion_example_02_before.jpg"/><span class="image_title">Original JPEG image.</span></div><a name="converted-image-320x175"></a><h5>Converted image (320x175)</h5><div class="&#10;&#9;&#9;&#9;&#9;&#9;image &#10;&#9;&#9;&#9;&#9;&#9;&#10;&#9;&#9;&#9;&#9;&#9;&#9;&#9;center&#10;&#9;&#9;&#9;&#9;&#9;&#9; "><img alt="Converted JPEG image." title="Converted JPEG image." src="img/imageconversion_example_02_after.jpg"/><span class="image_title">Converted JPEG image.</span></div><a name="complex-transformations"></a><a name="id6"></a><h4>Complex transformations</h4><p>The next example shows a more advanced transformation and some other features:</p><ol class="code">
<li><span style="color: #000000">&lt;?php</span></li>
<li></li>
<li><span style="color: #0000FF">require_once&nbsp;</span><span style="color: #335533">'tutorial_autoload.php'</span><span style="color: #0000FF">;</span></li>
<li></li>
<li><span style="color: #000000">$tutorialPath&nbsp;</span><span style="color: #0000FF">=&nbsp;</span><span style="color: #000000">dirname</span><span style="color: #0000FF">(&nbsp;</span><span style="color: #000000">__FILE__&nbsp;</span><span style="color: #0000FF">);</span></li>
<li></li>
<li><span style="color: #000000">$settings&nbsp;</span><span style="color: #0000FF">=&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageConverterSettings.html'>ezcImageConverterSettings</a></span><span style="color: #0000FF">(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;array(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageHandlerSettings.html'>ezcImageHandlerSettings</a></span><span style="color: #0000FF">(&nbsp;</span><span style="color: #335533">'GD'</span><span style="color: #0000FF">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'<a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageGdHandler.html'>ezcImageGdHandler</a>'&nbsp;</span><span style="color: #0000FF">),</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageHandlerSettings.html'>ezcImageHandlerSettings</a></span><span style="color: #0000FF">(&nbsp;</span><span style="color: #335533">'ImageMagick'</span><span style="color: #0000FF">,&nbsp;</span><span style="color: #335533">'<a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageImagemagickHandler.html'>ezcImageImagemagickHandler</a>'&nbsp;</span><span style="color: #0000FF">),</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;),</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;array(&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'image/gif'&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;</span><span style="color: #335533">'image/png'</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;)</span></li>
<li><span style="color: #0000FF">);</span></li>
<li></li>
<li><span style="color: #000000">$converter&nbsp;</span><span style="color: #0000FF">=&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageConverter.html'>ezcImageConverter</a></span><span style="color: #0000FF">(&nbsp;</span><span style="color: #000000">$settings&nbsp;</span><span style="color: #0000FF">);</span></li>
<li></li>
<li><span style="color: #000000">$filters&nbsp;</span><span style="color: #0000FF">=&nbsp;array(&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageFilter.html'>ezcImageFilter</a></span><span style="color: #0000FF">(&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'scale'</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'width'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;</span><span style="color: #000000">320</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'height'&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;</span><span style="color: #000000">240</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'direction'&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageGeometryFilters.html#constSCALE_DOWN'>ezcImageGeometryFilters::SCALE_DOWN</a></span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;),</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageFilter.html'>ezcImageFilter</a></span><span style="color: #0000FF">(&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'colorspace'</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'space'&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageColorspaceFilters.html#constCOLORSPACE_GREY'>ezcImageColorspaceFilters::COLORSPACE_GREY</a></span><span style="color: #0000FF">,&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;),</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageFilter.html'>ezcImageFilter</a></span><span style="color: #0000FF">(&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'border'</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'width'&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;</span><span style="color: #000000">5</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'color'&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;array(&nbsp;</span><span style="color: #000000">240</span><span style="color: #0000FF">,&nbsp;</span><span style="color: #000000">240</span><span style="color: #0000FF">,&nbsp;</span><span style="color: #000000">240&nbsp;</span><span style="color: #0000FF">),</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;),</span></li>
<li><span style="color: #0000FF">);</span></li>
<li></li>
<li><span style="color: #000000">$converter</span><span style="color: #0000FF">-&gt;</span><span style="color: #000000">createTransformation</span><span style="color: #0000FF">(&nbsp;</span><span style="color: #335533">'oldphoto'</span><span style="color: #0000FF">,&nbsp;</span><span style="color: #000000">$filters</span><span style="color: #0000FF">,&nbsp;array(&nbsp;</span><span style="color: #335533">'image/jpeg'</span><span style="color: #0000FF">,&nbsp;</span><span style="color: #335533">'image/png'&nbsp;</span><span style="color: #0000FF">)&nbsp;);</span></li>
<li></li>
<li><span style="color: #0000FF">try</span></li>
<li><span style="color: #0000FF">{</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">$converter</span><span style="color: #0000FF">-&gt;</span><span style="color: #000000">transform</span><span style="color: #0000FF">(&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'oldphoto'</span><span style="color: #0000FF">,&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">$tutorialPath</span><span style="color: #0000FF">.</span><span style="color: #335533">'/img/imageconversion_example_03_before.jpg'</span><span style="color: #0000FF">,&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">$tutorialPath</span><span style="color: #0000FF">.</span><span style="color: #335533">'/img/imageconversion_example_03_after.jpg'&nbsp;</span></li>
<li><span style="color: #335533">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF">);</span></li>
<li><span style="color: #0000FF">}</span></li>
<li><span style="color: #0000FF">catch&nbsp;(&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageTransformationException.html'>ezcImageTransformationException</a>&nbsp;$e</span><span style="color: #0000FF">)</span></li>
<li><span style="color: #0000FF">{</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;die(&nbsp;</span><span style="color: #335533">"Error&nbsp;transforming&nbsp;the&nbsp;image:&nbsp;&lt;</span><span style="color: #0000FF">{</span><span style="color: #000000">$e</span><span style="color: #0000FF">-&gt;</span><span style="color: #000000">getMessage</span><span style="color: #0000FF">()}</span><span style="color: #335533">&gt;"&nbsp;</span><span style="color: #0000FF">);</span></li>
<li><span style="color: #0000FF">}</span></li>
<li></li>
<li><span style="color: #000000">?&gt;</span></li>

</ol><p>In this example, there is a second parameter to the constructor of <a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageConverterSettings.html#__construct'>ezcImageConverterSettings::__construct</a>(), which defines explicit conversions between MIME types (line 13). In this case, we define that GIF images should be converted to PNG. When the transformation takes place, it will first check if an explicit conversion has been defined for the input MIME type. If this is the case, the explicit conversion will be performed. If not, the first available output MIME type will be chosen. Note that you have to add the new MIME output type "image/png" to the allowed output types of the transformation (see line 43).</p><p>In the transformation definition we define 3 filters. Note that the order of filters is important here. The first filter is "scale" again, after which the colorspace of the image is reduced to greyscale. The last filter adds a 5-pixel border with a near-white grey value to the image.</p><p>For this web tutorial, a JPEG image is once again used as the source:</p><a name="original-image-400x300"></a><h5>Original image (400x300):</h5><div class="&#10;&#9;&#9;&#9;&#9;&#9;image &#10;&#9;&#9;&#9;&#9;&#9;&#10;&#9;&#9;&#9;&#9;&#9;&#9;&#9;center&#10;&#9;&#9;&#9;&#9;&#9;&#9; "><img alt="Original JPEG image." title="Original JPEG image." src="img/imageconversion_example_03_before.jpg"/><span class="image_title">Original JPEG image.</span></div><a name="converted-image-330x250"></a><h5>Converted image (330x250):</h5><div class="&#10;&#9;&#9;&#9;&#9;&#9;image &#10;&#9;&#9;&#9;&#9;&#9;&#10;&#9;&#9;&#9;&#9;&#9;&#9;&#9;center&#10;&#9;&#9;&#9;&#9;&#9;&#9; "><img alt="Converted JPEG image." title="Converted JPEG image." src="img/imageconversion_example_03_after.jpg"/><span class="image_title">Converted JPEG image.</span></div><a name="adding-watermarks"></a><a name="id7"></a><h4>Adding watermarks</h4><p>A very convenient filter is the watermark filter, which allows you to place a your personal sign onto an image to ensure your copyright being kept:</p><ol class="code">
<li><span style="color: #000000">&lt;?php</span></li>
<li></li>
<li><span style="color: #0000FF">require_once&nbsp;</span><span style="color: #335533">'tutorial_autoload.php'</span><span style="color: #0000FF">;</span></li>
<li></li>
<li><span style="color: #000000">$tutorialPath&nbsp;</span><span style="color: #0000FF">=&nbsp;</span><span style="color: #000000">dirname</span><span style="color: #0000FF">(&nbsp;</span><span style="color: #000000">__FILE__&nbsp;</span><span style="color: #0000FF">);</span></li>
<li></li>
<li><span style="color: #000000">$settings&nbsp;</span><span style="color: #0000FF">=&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageConverterSettings.html'>ezcImageConverterSettings</a></span><span style="color: #0000FF">(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;array(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageHandlerSettings.html'>ezcImageHandlerSettings</a></span><span style="color: #0000FF">(&nbsp;</span><span style="color: #335533">'GD'</span><span style="color: #0000FF">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'<a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageGdHandler.html'>ezcImageGdHandler</a>'&nbsp;</span><span style="color: #0000FF">),</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageHandlerSettings.html'>ezcImageHandlerSettings</a></span><span style="color: #0000FF">(&nbsp;</span><span style="color: #335533">'ImageMagick'</span><span style="color: #0000FF">,&nbsp;</span><span style="color: #335533">'<a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageImagemagickHandler.html'>ezcImageImagemagickHandler</a>'&nbsp;</span><span style="color: #0000FF">),</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;),</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;array(&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'image/gif'&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;</span><span style="color: #335533">'image/png'</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;)</span></li>
<li><span style="color: #0000FF">);</span></li>
<li></li>
<li><span style="color: #000000">$converter&nbsp;</span><span style="color: #0000FF">=&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageConverter.html'>ezcImageConverter</a></span><span style="color: #0000FF">(&nbsp;</span><span style="color: #000000">$settings&nbsp;</span><span style="color: #0000FF">);</span></li>
<li></li>
<li><span style="color: #000000">$filters&nbsp;</span><span style="color: #0000FF">=&nbsp;array(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageFilter.html'>ezcImageFilter</a></span><span style="color: #0000FF">(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'watermarkAbsolute'</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'image'&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;</span><span style="color: #000000">$tutorialPath&nbsp;</span><span style="color: #0000FF">.&nbsp;</span><span style="color: #335533">'/img/watermark.png'</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'posX'&nbsp;&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;-</span><span style="color: #000000">52</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'posY'&nbsp;&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;-</span><span style="color: #000000">25</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;)</span></li>
<li><span style="color: #0000FF">);</span></li>
<li></li>
<li><span style="color: #000000">$converter</span><span style="color: #0000FF">-&gt;</span><span style="color: #000000">createTransformation</span><span style="color: #0000FF">(&nbsp;</span><span style="color: #335533">'watermark'</span><span style="color: #0000FF">,&nbsp;</span><span style="color: #000000">$filters</span><span style="color: #0000FF">,&nbsp;array(&nbsp;</span><span style="color: #335533">'image/jpeg'</span><span style="color: #0000FF">,&nbsp;</span><span style="color: #335533">'image/png'&nbsp;</span><span style="color: #0000FF">)&nbsp;);</span></li>
<li></li>
<li><span style="color: #0000FF">try</span></li>
<li><span style="color: #0000FF">{</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">$converter</span><span style="color: #0000FF">-&gt;</span><span style="color: #000000">transform</span><span style="color: #0000FF">(&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'watermark'</span><span style="color: #0000FF">,&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">$tutorialPath</span><span style="color: #0000FF">.</span><span style="color: #335533">'/img/imageconversion_example_04_before.jpg'</span><span style="color: #0000FF">,&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">$tutorialPath</span><span style="color: #0000FF">.</span><span style="color: #335533">'/img/imageconversion_example_04_after.jpg'&nbsp;</span></li>
<li><span style="color: #335533">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF">);</span></li>
<li><span style="color: #0000FF">}</span></li>
<li><span style="color: #0000FF">catch&nbsp;(&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageTransformationException.html'>ezcImageTransformationException</a>&nbsp;$e</span><span style="color: #0000FF">)</span></li>
<li><span style="color: #0000FF">{</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;die(&nbsp;</span><span style="color: #335533">"Error&nbsp;transforming&nbsp;the&nbsp;image:&nbsp;&lt;</span><span style="color: #0000FF">{</span><span style="color: #000000">$e</span><span style="color: #0000FF">-&gt;</span><span style="color: #000000">getMessage</span><span style="color: #0000FF">()}</span><span style="color: #335533">&gt;"&nbsp;</span><span style="color: #0000FF">);</span></li>
<li><span style="color: #0000FF">}</span></li>
<li></li>
<li><span style="color: #000000">?&gt;</span></li>

</ol><p>This code snippet creates a simple transformation to place the watermark. The 'image' parameter contains the path to the watermark image, while posX and posY define, where the watermark will be placed on the converted image. The positions are defined from the bottom left corner, so in this case therer will be 10 pixel left between the watermark and the image border.</p><a name="original-image-without-watermark"></a><h5>Original image (without watermark):</h5><div class="&#10;&#9;&#9;&#9;&#9;&#9;image &#10;&#9;&#9;&#9;&#9;&#9;&#10;&#9;&#9;&#9;&#9;&#9;&#9;&#9;center&#10;&#9;&#9;&#9;&#9;&#9;&#9; "><img alt="Original JPEG image without watermark." title="Original JPEG image without watermark." src="img/imageconversion_example_04_before.jpg"/><span class="image_title">Original JPEG image without watermark.</span></div><a name="converted-image-with-watermark"></a><h5>Converted image (with watermark):</h5><div class="&#10;&#9;&#9;&#9;&#9;&#9;image &#10;&#9;&#9;&#9;&#9;&#9;&#10;&#9;&#9;&#9;&#9;&#9;&#9;&#9;center&#10;&#9;&#9;&#9;&#9;&#9;&#9; "><img alt="Converted JPEG image with watermark." title="Converted JPEG image with watermark." src="img/imageconversion_example_04_after.jpg"/><span class="image_title">Converted JPEG image with watermark.</span></div><p>It is also possible to get the size of the watermark image adjusted on the fly and a second filter is available, which allows to define all values as percentage values, in respect to the destination image.</p><a name="creating-thumbnails"></a><a name="id8"></a><h4>Creating thumbnails</h4><p>The following example shows how to create a thumbnail from an image very easily:</p><ol class="code">
<li><span style="color: #000000">&lt;?php</span></li>
<li></li>
<li><span style="color: #0000FF">require_once&nbsp;</span><span style="color: #335533">'tutorial_autoload.php'</span><span style="color: #0000FF">;</span></li>
<li></li>
<li><span style="color: #000000">$tutorialPath&nbsp;</span><span style="color: #0000FF">=&nbsp;</span><span style="color: #000000">dirname</span><span style="color: #0000FF">(&nbsp;</span><span style="color: #000000">__FILE__&nbsp;</span><span style="color: #0000FF">);</span></li>
<li></li>
<li><span style="color: #000000">$settings&nbsp;</span><span style="color: #0000FF">=&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageConverterSettings.html'>ezcImageConverterSettings</a></span><span style="color: #0000FF">(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;array(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageHandlerSettings.html'>ezcImageHandlerSettings</a></span><span style="color: #0000FF">(&nbsp;</span><span style="color: #335533">'GD'</span><span style="color: #0000FF">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'<a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageGdHandler.html'>ezcImageGdHandler</a>'&nbsp;</span><span style="color: #0000FF">),</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageHandlerSettings.html'>ezcImageHandlerSettings</a></span><span style="color: #0000FF">(&nbsp;</span><span style="color: #335533">'ImageMagick'</span><span style="color: #0000FF">,&nbsp;</span><span style="color: #335533">'<a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageImagemagickHandler.html'>ezcImageImagemagickHandler</a>'&nbsp;</span><span style="color: #0000FF">),</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;),</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;array(&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'image/gif'&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;</span><span style="color: #335533">'image/png'</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;)</span></li>
<li><span style="color: #0000FF">);</span></li>
<li></li>
<li><span style="color: #000000">$converter&nbsp;</span><span style="color: #0000FF">=&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageConverter.html'>ezcImageConverter</a></span><span style="color: #0000FF">(&nbsp;</span><span style="color: #000000">$settings&nbsp;</span><span style="color: #0000FF">);</span></li>
<li></li>
<li><span style="color: #000000">$filters&nbsp;</span><span style="color: #0000FF">=&nbsp;array(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageFilter.html'>ezcImageFilter</a></span><span style="color: #0000FF">(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'filledThumbnail'</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'width'&nbsp;&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;</span><span style="color: #000000">100</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'height'&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;</span><span style="color: #000000">100</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'color'&nbsp;&nbsp;</span><span style="color: #0000FF">=&gt;&nbsp;array(</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">200</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">200</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">200</span><span style="color: #0000FF">,</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;)</span></li>
<li><span style="color: #0000FF">);</span></li>
<li></li>
<li><span style="color: #000000">$converter</span><span style="color: #0000FF">-&gt;</span><span style="color: #000000">createTransformation</span><span style="color: #0000FF">(&nbsp;</span><span style="color: #335533">'thumbnail'</span><span style="color: #0000FF">,&nbsp;</span><span style="color: #000000">$filters</span><span style="color: #0000FF">,&nbsp;array(&nbsp;</span><span style="color: #335533">'image/jpeg'</span><span style="color: #0000FF">,&nbsp;</span><span style="color: #335533">'image/png'&nbsp;</span><span style="color: #0000FF">)&nbsp;);</span></li>
<li></li>
<li><span style="color: #0000FF">try</span></li>
<li><span style="color: #0000FF">{</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">$converter</span><span style="color: #0000FF">-&gt;</span><span style="color: #000000">transform</span><span style="color: #0000FF">(&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #335533">'thumbnail'</span><span style="color: #0000FF">,&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">$tutorialPath</span><span style="color: #0000FF">.</span><span style="color: #335533">'/img/imageconversion_example_05_before.jpg'</span><span style="color: #0000FF">,&nbsp;</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000">$tutorialPath</span><span style="color: #0000FF">.</span><span style="color: #335533">'/img/imageconversion_example_05_after.jpg'&nbsp;</span></li>
<li><span style="color: #335533">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF">);</span></li>
<li><span style="color: #0000FF">}</span></li>
<li><span style="color: #0000FF">catch&nbsp;(&nbsp;</span><span style="color: #000000"><a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageTransformationException.html'>ezcImageTransformationException</a>&nbsp;$e</span><span style="color: #0000FF">)</span></li>
<li><span style="color: #0000FF">{</span></li>
<li><span style="color: #0000FF">&nbsp;&nbsp;&nbsp;&nbsp;die(&nbsp;</span><span style="color: #335533">"Error&nbsp;transforming&nbsp;the&nbsp;image:&nbsp;&lt;</span><span style="color: #0000FF">{</span><span style="color: #000000">$e</span><span style="color: #0000FF">-&gt;</span><span style="color: #000000">getMessage</span><span style="color: #0000FF">()}</span><span style="color: #335533">&gt;"&nbsp;</span><span style="color: #0000FF">);</span></li>
<li><span style="color: #0000FF">}</span></li>
<li></li>
<li><span style="color: #000000">?&gt;</span></li>

</ol><p>While there is also a 'croppedThumbnail' filter available, which croppes overhead from the scaled image, this filter fills the overhead from scaling with the given fill color. The image is automatically scaled down to fit the given thumbnail size.</p><a name="original-image-original-size"></a><h5>Original image (original size):</h5><div class="&#10;&#9;&#9;&#9;&#9;&#9;image &#10;&#9;&#9;&#9;&#9;&#9;&#10;&#9;&#9;&#9;&#9;&#9;&#9;&#9;center&#10;&#9;&#9;&#9;&#9;&#9;&#9; "><img alt="Original JPEG image without watermark." title="Original JPEG image without watermark." src="img/imageconversion_example_05_before.jpg"/><span class="image_title">Original JPEG image without watermark.</span></div><a name="converted-image-thumbnail"></a><h5>Converted image (thumbnail):</h5><div class="&#10;&#9;&#9;&#9;&#9;&#9;image &#10;&#9;&#9;&#9;&#9;&#9;&#10;&#9;&#9;&#9;&#9;&#9;&#9;&#9;center&#10;&#9;&#9;&#9;&#9;&#9;&#9; "><img alt="Converted JPEG image with watermark." title="Converted JPEG image with watermark." src="img/imageconversion_example_05_after.jpg"/><span class="image_title">Converted JPEG image with watermark.</span></div><a name="troubleshooting"></a><a name="id9"></a><h3>Troubleshooting</h3><p>In some cases, you might experience troubles, which result from PHP or one of the drivers. Common problems and solutions are presented below.</p><a name="corrupt-jpeg-files"></a><a name="id10"></a><h4>Corrupt JPEG files</h4><p>Some JPEG files contain small amounts of corrupt data, which might not result in problems when viewing these images with your favorite image viewer. However, GD and ImageMagick by default issue errors for these images. The ImageConversion component throws an <a href='/zetacomponents/documentation/trunk/ImageConversion/phpdoc/ezcImageFileNotProcessable.html'>ezcImageFileNotProcessable</a> exception in this case.</p><p>You can avoid this issue in the GD driver, by setting the php.ini directive "gd.jpeg_ignore_warning" to true. This can either happen in your php.ini directly or by using the following code in your application, before you attempt to load any image:</p><ol class="code">
<li><span style="color: #000000">&lt;?php</span></li>
<li><span style="color: #000000">&nbsp;&nbsp;&nbsp;&nbsp;ini_set</span><span style="color: #0000FF">(&nbsp;</span><span style="color: #335533">"gd.jpeg_ignore_warning"</span><span style="color: #0000FF">,&nbsp;</span><span style="color: #000000">true&nbsp;</span><span style="color: #0000FF">);</span></li>
<span style="color: #000000">?&gt;</span>
</ol><p>However, it is not recommended to deal with corrupt images like this, since the results are unpredictable. There is a good chance that the converted image will be OK, but it is not guaranteed.</p><!--Local Variables:
mode: rst
fill-column: 79
End:
vim: et syn=rst tw=79-->

	</div>

	<div class="footer">
	
</div>
</div>
</body>
</html>
