<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html 
	xmlns="http://www.w3.org/1999/xhtml"
	xml:lang="en"
	lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

	<meta name="description" content="Apache Zeta Components - reusable set of high quality PHP components to fasten your development." />
	<meta name="keywords" content="PHP, apache, components, framework, quality" />
	<meta name="author" content="dotxp" />
	<meta name="language" content="en" />
	<meta name="date" content="Wed, 04 Aug 2010 13:07:14 +0200" />
	<meta name="robots" content="all" />

	<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
	<meta name="DC.title" content="ezcAuthenticationSession.html" />
	<meta name="DC.creator" content="dotxp" />
	<meta name="DC.date" content="Wed, 04 Aug 2010 13:07:14 +0200" />
	<meta name="DC.rights" content="Copyright" />

	<link rel="meta" href="/zetacomponents/documentation/trunk/Authentication/phpdoc/ezcAuthenticationSession.rdf" />
	<link rel="icon" href="/zetacomponents/images/favicon.png" type="image/png" />

	<link rel="Stylesheet" type="text/css" href="/zetacomponents/styles/screen.css" media="screen" />
	<link rel="Stylesheet" type="text/css" href="/zetacomponents/styles/print.css" media="print" />


	<title>Apache Zeta Components - high quality PHP components</title>
</head>
<body>
<div id="wcv">
	<h1>
		<a id="header-png" href="/zetacomponents" title="Apache Zeta Components - high quality PHP components">
			Apache Zeta Components - high quality PHP components
		</a>
	</h1>

	<ul class="navigation">
<li >
	<a href="/zetacomponents/news.html" title="About">About</a>
	</li>
<li >
	<a href="/zetacomponents/community/index.html" title="Community">Community</a>
	</li>
<li class="requested">
	<a href="/zetacomponents/documentation/overview.html" title="Documentation">Documentation</a>
	</li>
<li >
	<a href="/zetacomponents/download/index.html" title="Download">Download</a>
	</li>
<li >
	<a href="/zetacomponents/support.html" title="Support">Support</a>
	</li>

</ul>
<ul class="subnavigation">
<li >
	<a href="/zetacomponents/documentation/overview.html" title="Overview">Overview</a>
	</li>
<li >
	<a href="/zetacomponents/documentation/install.html" title="Installation">Installation</a>
	</li>

</ul>

	<div class="content">
    <ul class="tabs">
    <li >
	<a href="/zetacomponents/documentation/trunk/Authentication/tutorial.html" title="Tutorial">Tutorial</a>
	</li>
<li class="requested">
	<a href="/zetacomponents/documentation/trunk/Authentication/phpdoc/classtrees.html" title="API">API</a>
	</li>
<li >
	<a href="/zetacomponents/documentation/trunk/Authentication/security.html" title="Security ">Security </a>
	</li>
<li >
	<a href="/zetacomponents/documentation/trunk/Authentication/rfcs.html" title="Rfcs ">Rfcs </a>
	</li>

</ul>

		
  <div class="phpdoc">
    <h2>Apache Zeta Components Manual :: Docs For Class ezcAuthenticationSession</h2>

                  <h3>Authentication::ezcAuthenticationSession</h3>
    
<a name="sec-description"></a>
<h3>Class ezcAuthenticationSession</h3>

<p>Support for session authentication and saving of authentication information  between requests.</p><div><p>Contains the methods: </p><ul><li>start - starts the session, calling the PHP function session_start()</li><li>load - returns the information stored in the session key ezcAuth_id</li><li>save - saves information in the session key ezcAuth_id and also saves
          the current timestamp in the session key ezcAuth_timestamp</li><li>destroy - deletes the information stored in the session keys ezcAuth_id
             and ezcAuth_timestamp</li><li>regenerateId - regenerates the PHPSESSID value</li></ul>  Example of use (combined with the Htpasswd filter):  <ol><li><div class="src-line">&#8192;<span class="src-comm">//&#8192;no&#8192;headers&#8192;should&#8192;be&#8192;sent&#8192;before&#8192;calling&#8192;$session-&gt;start()</span></div></li>
<li><div class="src-line">&#8192;<span class="src-var">$session&#8192;</span>=&#8192;<span class="src-key">new&#8192;</span><span class="src-id"><a href="ezcAuthenticationSession.html">ezcAuthenticationSession</a></span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&#8192;<span class="src-var">$session</span><span class="src-sym">-&gt;</span><a href="ezcAuthenticationSession.html#methodstart">start</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&#8192;</div></li>
<li><div class="src-line">&#8192;<span class="src-comm">//&#8192;retrieve&#8192;the&#8192;POST&#8192;request&#8192;information</span></div></li>
<li><div class="src-line">&#8192;<span class="src-var">$user&#8192;</span>=&#8192;isset<span class="src-sym">(&#8192;</span><span class="src-var">$_POST</span><span class="src-sym">[</span><span class="src-str">'user'</span><span class="src-sym">]&#8192;</span><span class="src-sym">)&#8192;</span>?&#8192;<span class="src-var">$_POST</span><span class="src-sym">[</span><span class="src-str">'user'</span><span class="src-sym">]&#8192;</span>:&#8192;<span class="src-var">$session</span><span class="src-sym">-&gt;</span><a href="ezcAuthenticationSession.html#methodload">load</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&#8192;<span class="src-var">$password&#8192;</span>=&#8192;isset<span class="src-sym">(&#8192;</span><span class="src-var">$_POST</span><span class="src-sym">[</span><span class="src-str">'password'</span><span class="src-sym">]&#8192;</span><span class="src-sym">)&#8192;</span>?&#8192;<span class="src-var">$_POST</span><span class="src-sym">[</span><span class="src-str">'password'</span><span class="src-sym">]&#8192;</span>:&#8192;<span class="src-id">null</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&#8192;<span class="src-var">$credentials&#8192;</span>=&#8192;<span class="src-key">new&#8192;</span><span class="src-id"><a href="ezcAuthenticationPasswordCredentials.html">ezcAuthenticationPasswordCredentials</a></span><span class="src-sym">(&#8192;</span><span class="src-var">$user</span><span class="src-sym">,&#8192;</span><span class="src-var">$password&#8192;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&#8192;<span class="src-var">$authentication&#8192;</span>=&#8192;<span class="src-key">new&#8192;</span><span class="src-id"><a href="ezcAuthentication.html">ezcAuthentication</a></span><span class="src-sym">(&#8192;</span><span class="src-var">$credentials&#8192;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&#8192;<span class="src-var">$authentication</span><span class="src-sym">-&gt;</span><span class="src-id">session&#8192;</span>=&#8192;<span class="src-var">$session</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&#8192;<span class="src-var">$authentication</span><span class="src-sym">-&gt;</span><span class="src-id">addFilter</span><span class="src-sym">(&#8192;</span><span class="src-key">new&#8192;</span><span class="src-id"><a href="ezcAuthenticationHtpasswdFilter.html">ezcAuthenticationHtpasswdFilter</a></span><span class="src-sym">(&#8192;</span><span class="src-str">'/etc/htpasswd'&#8192;</span><span class="src-sym">)&#8192;)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&#8192;<span class="src-comm">//&#8192;add&#8192;other&#8192;filters&#8192;if&#8192;needed</span></div></li>
<li><div class="src-line">&#8192;<span class="src-key">if&#8192;</span><span class="src-sym">(&#8192;</span><span class="src-sym">!</span><span class="src-var">$authentication</span><span class="src-sym">-&gt;</span><a href="ezcAuthenticationSession.html#methodrun">run</a><span class="src-sym">(</span><span class="src-sym">)&#8192;)</span></div></li>
<li><div class="src-line">&#8192;<span class="src-sym">{</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-comm">//&#8192;authentication&#8192;did&#8192;not&#8192;succeed,&#8192;so&#8192;inform&#8192;the&#8192;user</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-var">$status&#8192;</span>=&#8192;<span class="src-var">$authentication</span><span class="src-sym">-&gt;</span><span class="src-id">getStatus</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-var">$err&#8192;</span>=&#8192;<span class="src-key">array</span><span class="src-sym">(</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-str">'ezcAuthenticationHtpasswdFilter'&#8192;</span>=&gt;&#8192;<span class="src-key">array</span><span class="src-sym">(</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-id"><a href="ezcAuthenticationHtpasswdFilter.html">ezcAuthenticationHtpasswdFilter</a></span><span class="src-sym">::</span><span class="src-id">STATUS_USERNAME_INCORRECT&#8192;</span>=&gt;&#8192;<span class="src-str">'Incorrect&#8192;username'</span><span class="src-sym">,</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-id"><a href="ezcAuthenticationHtpasswdFilter.html">ezcAuthenticationHtpasswdFilter</a></span><span class="src-sym">::</span><span class="src-id">STATUS_PASSWORD_INCORRECT&#8192;</span>=&gt;&#8192;<span class="src-str">'Incorrect&#8192;password'</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-sym">)</span><span class="src-sym">,</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-str">'ezcAuthenticationSession'&#8192;</span>=&gt;&#8192;<span class="src-key">array</span><span class="src-sym">(</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-id"><a href="ezcAuthenticationSession.html">ezcAuthenticationSession</a></span><span class="src-sym">::</span><span class="src-id">STATUS_EMPTY&#8192;</span>=&gt;&#8192;<span class="src-str">''</span><span class="src-sym">,</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-id"><a href="ezcAuthenticationSession.html">ezcAuthenticationSession</a></span><span class="src-sym">::</span><span class="src-id">STATUS_EXPIRED&#8192;</span>=&gt;&#8192;<span class="src-str">'Session&#8192;expired'</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-sym">)</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-key">foreach&#8192;</span><span class="src-sym">(&#8192;</span><span class="src-var">$status&#8192;</span><span class="src-key">as&#8192;</span><span class="src-var">$line&#8192;</span><span class="src-sym">)</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-sym">{</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;list<span class="src-sym">(&#8192;</span><span class="src-var">$key</span><span class="src-sym">,&#8192;</span><span class="src-var">$value&#8192;</span><span class="src-sym">)&#8192;</span>=&#8192;<a href="http://www.php.net/each">each</a><span class="src-sym">(&#8192;</span><span class="src-var">$line&#8192;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;echo&#8192;<span class="src-var">$err</span><span class="src-sym">[</span><span class="src-var">$key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-var">$value</span><span class="src-sym">]&#8192;</span>.&#8192;<span class="src-str">"\n"</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-sym">}</span></div></li>
<li><div class="src-line">&#8192;<span class="src-sym">}</span></div></li>
<li><div class="src-line">&#8192;<span class="src-key">else</span></div></li>
<li><div class="src-line">&#8192;<span class="src-sym">{</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-comm">//&#8192;authentication&#8192;succeeded,&#8192;so&#8192;allow&#8192;the&#8192;user&#8192;to&#8192;see&#8192;his&#8192;content</span></div></li>
<li><div class="src-line">&#8192;<span class="src-sym">}</span></div></li>
</ol><p>See <a href="ezcAuthenticationSessionOptions.html">ezcAuthenticationSessionOptions</a> for options you can set to  session objects.</p></div>
<p>Source for this file: <a href="http://fisheye6.atlassian.com/browse/zetacomponents/trunk/Authentication/src/session/authentication_session.php?r=HEAD">/Authentication/src/session/authentication_session.php</a></p>
       




  <table><tr><td>
            <strong>Version:</strong>&#8192;&#8192;
          </td>
          <td>//autogen//</td>
        </tr></table><a name="sec-const-summary"></a>
  <h3>Constants</h3>
  <table class="summary"><tr><td class="right">
          <a name="const-STATUS_EMPTY" id=""></a>
          <code>
            <a href="#const-STATUS_EMPTY" title="details" class="const-name-summary">STATUS_EMPTY</a>
             =  1
          </code>
        </td>
        <td>
          The session is empty; normal behaviour is to continue with the other filters.                  </td>
      </tr><tr><td class="right">
          <a name="const-STATUS_EXPIRED" id=""></a>
          <code>
            <a href="#const-STATUS_EXPIRED" title="details" class="const-name-summary">STATUS_EXPIRED</a>
             =  2
          </code>
        </td>
        <td>
          The session expired; normal behaviour is to regenerate the session ID.                  </td>
      </tr><tr><td class="right">
          <a name="const-STATUS_OK" id=""></a>
          <code>
            <a href="#const-STATUS_OK" title="details" class="const-name-summary">STATUS_OK</a>
             =  0
          </code>
        </td>
        <td>
          Successful authentication; normal behaviour is to skip the other filters.          <p>This should be the same value as ezcAuthenticationFilter::STATUS_OK.</p>        </td>
      </tr></table><a name="sec-var-summary"></a>
  <h3>Member Variables</h3>
  <table class="summary"><tr><td class="right">
            <em>protected</em>            <em><a href="ezcAuthenticationFilterOptions.html">ezcAuthenticationFilterOptions</a></em>          </td>
          <td>
            <code>
              $options
                          </code>
            <br><div style="margin-left: 20px">Options for authentication filters.</div>                      </td>
        </tr></table><a name="sec-method-summary"></a>
  <h3>Method Summary</h3>
  <table class="summary"><tr><td class="right">
            <em>public</em>                        <em>ezcAuthenticationSession</em>          </td>
          <td>
            <code>
              <a href="#__construct"><b>__construct</b></a>(
                                                                  [                  $options
                   = null]                               )
            </code>
            <br><div style="margin-left: 20px">Creates a new object of this class.</div>          </td>
        </tr><tr><td class="right">
            <em>public</em>                        <em>void</em>          </td>
          <td>
            <code>
              <a href="#destroy"><b>destroy</b></a>(
               )
            </code>
            <br><div style="margin-left: 20px">Removes the variables used by this class from the session variables.</div>          </td>
        </tr><tr><td class="right">
            <em>public</em>                        <em><a href="ezcAuthenticationSessionOptions.html">ezcAuthenticationSessionOptions</a></em>          </td>
          <td>
            <code>
              <a href="#getOptions"><b>getOptions</b></a>(
               )
            </code>
            <br><div style="margin-left: 20px">Returns the options of this class.</div>          </td>
        </tr><tr><td class="right">
            <em>public</em>                        <em>bool</em>          </td>
          <td>
            <code>
              <a href="#isValid"><b>isValid</b></a>(
                                                                                    $credentials
                                                 )
            </code>
            <br><div style="margin-left: 20px">Runs through the session and returns true if the session is correct.</div>          </td>
        </tr><tr><td class="right">
            <em>public</em>                        <em>string</em>          </td>
          <td>
            <code>
              <a href="#load"><b>load</b></a>(
               )
            </code>
            <br><div style="margin-left: 20px">Loads the authenticated username from the session or null if it doesn't exist.</div>          </td>
        </tr><tr><td class="right">
            <em>public</em>                        <em>void</em>          </td>
          <td>
            <code>
              <a href="#regenerateId"><b>regenerateId</b></a>(
               )
            </code>
            <br><div style="margin-left: 20px">Regenerates the session ID.</div>          </td>
        </tr><tr><td class="right">
            <em>public</em>                        <em>int</em>          </td>
          <td>
            <code>
              <a href="#run"><b>run</b></a>(
                                                                                    $credentials
                                                 )
            </code>
            <br><div style="margin-left: 20px">Runs through the session and returns a status code when finished.</div>          </td>
        </tr><tr><td class="right">
            <em>public</em>                        <em>void</em>          </td>
          <td>
            <code>
              <a href="#save"><b>save</b></a>(
                                                                                    $data
                                                 )
            </code>
            <br><div style="margin-left: 20px">Saves the authenticated username and the current timestamp in the session  variables.</div>          </td>
        </tr><tr><td class="right">
            <em>public</em>                        <em>void</em>          </td>
          <td>
            <code>
              <a href="#setOptions"><b>setOptions</b></a>(
                                                                                    $options
                                                 )
            </code>
            <br><div style="margin-left: 20px">Sets the options of this class to $options.</div>          </td>
        </tr><tr><td class="right">
            <em>public</em>                        <em>void</em>          </td>
          <td>
            <code>
              <a href="#start"><b>start</b></a>(
               )
            </code>
            <br><div style="margin-left: 20px">Starts the session.</div>          </td>
        </tr></table><a name="sec-methods"></a>
  <h3>Methods</h3>
  <a name="method_detail"></a>
                    
      <a name="method__construct" id="__construct"><!-- --></a>

    <h4>__construct</h4>

    <div class="method-signature">
      ezcAuthenticationSession
      __construct(
                                  [<a href="ezcAuthenticationSessionOptions.html">ezcAuthenticationSessionOptions</a>
          $options
           = null]              )
    </div>

    <p>Creates a new object of this class.</p>
          <h5>Parameters:</h5>
      <table class="detail"><thead><tr><th>Name</th>
            <th>Type</th>
            <th class="desc">Description</th>
          </tr></thead><tbody><tr><td><code>$options</code></td>
              <td><em><a href="ezcAuthenticationSessionOptions.html">ezcAuthenticationSessionOptions</a></em></td>
              <td>
                                  Options for this class
                              </td>
            </tr></tbody></table><a name="methoddestroy" id="destroy"><!-- --></a>

    <h4>destroy</h4>

    <div class="method-signature">
      void
      destroy(
      )
    </div>

    <p>Removes the variables used by this class from the session variables.</p>
    
        

    
    
    
        <a name="methodgetOptions" id="getOptions"><!-- --></a>

    <h4>getOptions</h4>

    <div class="method-signature">
      <a href="ezcAuthenticationSessionOptions.html">ezcAuthenticationSessionOptions</a>
      getOptions(
      )
    </div>

    <p>Returns the options of this class.</p>
    
        

    
    
    
        <a name="methodisValid" id="isValid"><!-- --></a>

    <h4>isValid</h4>

    <div class="method-signature">
      bool
      isValid(
                                  <a href="ezcAuthenticationCredentials.html">ezcAuthenticationCredentials</a>
          $credentials
                        )
    </div>

    <p>Runs through the session and returns true if the session is correct.</p><div><p>When using the session, it is often desirable to take advantage of the  fact that the authenticated state of the user is kept in the session and  not create and initialize the other filters (which might slow things  down on every request).</p><p>The application can be structured like this:  </p><ol><li><div class="src-line">&#8192;<span class="src-var">$session&#8192;</span>=&#8192;<span class="src-key">new&#8192;</span><span class="src-id"><a href="ezcAuthenticationSession.html">ezcAuthenticationSession</a></span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&#8192;<span class="src-var">$session</span><span class="src-sym">-&gt;</span><a href="ezcAuthenticationSession.html#methodstart">start</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&#8192;</div></li>
<li><div class="src-line">&#8192;<span class="src-var">$credentials&#8192;</span>=&#8192;<span class="src-key">new&#8192;</span><span class="src-id"><a href="ezcAuthenticationPasswordCredentials.html">ezcAuthenticationPasswordCredentials</a></span><span class="src-sym">(&#8192;</span><span class="src-var">$user</span><span class="src-sym">,&#8192;</span><span class="src-var">$pass&#8192;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&#8192;</div></li>
<li><div class="src-line">&#8192;<span class="src-var">$authenticated&#8192;</span>=&#8192;<span class="src-id">false</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&#8192;<span class="src-key">if&#8192;</span><span class="src-sym">(&#8192;</span><span class="src-sym">!</span><span class="src-var">$session</span><span class="src-sym">-&gt;</span><a href="ezcAuthenticationSession.html#methodisValid">isValid</a><span class="src-sym">(&#8192;</span><span class="src-var">$credentials&#8192;</span><span class="src-sym">)&#8192;)</span></div></li>
<li><div class="src-line">&#8192;<span class="src-sym">{</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-comm">//&#8192;create&#8192;the&#8192;authentication&#8192;object</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-var">$authentication&#8192;</span>=&#8192;<span class="src-key">new&#8192;</span><span class="src-id"><a href="ezcAuthentication.html">ezcAuthentication</a></span><span class="src-sym">(&#8192;</span><span class="src-var">$credentials&#8192;</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-var">$authentication</span><span class="src-sym">-&gt;</span><span class="src-id">session&#8192;</span>=&#8192;<span class="src-var">$session</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&#8192;</div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-comm">//&#8192;create&#8192;filters&#8192;and&#8192;add&#8192;them&#8192;to&#8192;the&#8192;authentication&#8192;object</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-var">$authentication</span><span class="src-sym">-&gt;</span><span class="src-id">addFilter</span><span class="src-sym">(&#8192;</span><span class="src-key">new&#8192;</span><span class="src-id"><a href="ezcAuthenticationOpenidFilter.html">ezcAuthenticationOpenidFilter</a></span><span class="src-sym">(</span><span class="src-sym">)&#8192;)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&#8192;</div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-comm">//&#8192;run&#8192;the&#8192;authentication&#8192;object</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-key">if&#8192;</span><span class="src-sym">(&#8192;</span><span class="src-sym">!</span><span class="src-var">$authentication</span><span class="src-sym">-&gt;</span><a href="ezcAuthenticationSession.html#methodrun">run</a><span class="src-sym">(</span><span class="src-sym">)&#8192;)</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-sym">{</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-var">$status&#8192;</span>=&#8192;<span class="src-var">$authentication</span><span class="src-sym">-&gt;</span><span class="src-id">getStatus</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-comm">//&#8192;build&#8192;an&#8192;error&#8192;message&#8192;based&#8192;on&#8192;$status</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-sym">}</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-key">else</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-sym">{</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-var">$authenticated&#8192;</span>=&#8192;<span class="src-id">true</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-sym">}</span></div></li>
<li><div class="src-line">&#8192;<span class="src-sym">}</span></div></li>
<li><div class="src-line">&#8192;<span class="src-key">else</span></div></li>
<li><div class="src-line">&#8192;<span class="src-sym">{</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-var">$authenticated&#8192;</span>=&#8192;<span class="src-id">true</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&#8192;<span class="src-sym">}</span></div></li>
<li><div class="src-line">&#8192;</div></li>
<li><div class="src-line">&#8192;<span class="src-key">if&#8192;</span><span class="src-sym">(&#8192;</span><span class="src-var">$authenticated&#8192;</span><span class="src-sym">)</span></div></li>
<li><div class="src-line">&#8192;<span class="src-sym">{</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-comm">//&#8192;the&#8192;authentication&#8192;succeeded&#8192;and&#8192;the&#8192;user&#8192;can&#8192;see&#8192;his&#8192;content</span></div></li>
<li><div class="src-line">&#8192;<span class="src-sym">}</span></div></li>
<li><div class="src-line">&#8192;<span class="src-key">else</span></div></li>
<li><div class="src-line">&#8192;<span class="src-sym">{</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-comm">//&#8192;inform&#8192;the&#8192;user&#8192;that&#8192;the&#8192;authentication&#8192;failed&#8192;(with&#8192;the&#8192;error</span></div></li>
<li><div class="src-line">&#8192;&#8192;&#8192;&#8192;&#8192;<span class="src-comm">//&#8192;message&#8192;that&#8192;was&#8192;created&#8192;earlier)</span></div></li>
<li><div class="src-line">&#8192;<span class="src-sym">}</span></div></li>
</ol><p>In this way, the creation and initialization of the authentication  filters is not performed if the credentials are stored in the session.</p></div>
          <h5>Parameters:</h5>
      <table class="detail"><thead><tr><th>Name</th>
            <th>Type</th>
            <th class="desc">Description</th>
          </tr></thead><tbody><tr><td><code>$credentials</code></td>
              <td><em><a href="ezcAuthenticationCredentials.html">ezcAuthenticationCredentials</a></em></td>
              <td>
                                  Authentication credentials
                              </td>
            </tr></tbody></table><a name="methodload" id="load"><!-- --></a>

    <h4>load</h4>

    <div class="method-signature">
      string
      load(
      )
    </div>

    <p>Loads the authenticated username from the session or null if it doesn't exist.</p>
    
        

    
    
    
        <a name="methodregenerateId" id="regenerateId"><!-- --></a>

    <h4>regenerateId</h4>

    <div class="method-signature">
      void
      regenerateId(
      )
    </div>

    <p>Regenerates the session ID.</p>
    
        

    
    
    
        <a name="methodrun" id="run"><!-- --></a>

    <h4>run</h4>

    <div class="method-signature">
      int
      run(
                                  <a href="ezcAuthenticationCredentials.html">ezcAuthenticationCredentials</a>
          $credentials
                        )
    </div>

    <p>Runs through the session and returns a status code when finished.</p>
          <h5>Parameters:</h5>
      <table class="detail"><thead><tr><th>Name</th>
            <th>Type</th>
            <th class="desc">Description</th>
          </tr></thead><tbody><tr><td><code>$credentials</code></td>
              <td><em><a href="ezcAuthenticationCredentials.html">ezcAuthenticationCredentials</a></em></td>
              <td>
                                  Authentication credentials
                              </td>
            </tr></tbody></table><a name="methodsave" id="save"><!-- --></a>

    <h4>save</h4>

    <div class="method-signature">
      void
      save(
                                  string
          $data
                        )
    </div>

    <p>Saves the authenticated username and the current timestamp in the session  variables.</p>
          <h5>Parameters:</h5>
      <table class="detail"><thead><tr><th>Name</th>
            <th>Type</th>
            <th class="desc">Description</th>
          </tr></thead><tbody><tr><td><code>$data</code></td>
              <td><em>string</em></td>
              <td>
                                  Information to save in the session, usually username
                              </td>
            </tr></tbody></table><a name="methodsetOptions" id="setOptions"><!-- --></a>

    <h4>setOptions</h4>

    <div class="method-signature">
      void
      setOptions(
                                  <a href="ezcAuthenticationSessionOptions.html">ezcAuthenticationSessionOptions</a>
          $options
                        )
    </div>

    <p>Sets the options of this class to $options.</p>
          <h5>Parameters:</h5>
      <table class="detail"><thead><tr><th>Name</th>
            <th>Type</th>
            <th class="desc">Description</th>
          </tr></thead><tbody><tr><td><code>$options</code></td>
              <td><em><a href="ezcAuthenticationSessionOptions.html">ezcAuthenticationSessionOptions</a></em></td>
              <td>
                                  Options for this class
                              </td>
            </tr></tbody></table><a name="methodstart" id="start"><!-- --></a>

    <h4>start</h4>

    <div class="method-signature">
      void
      start(
      )
    </div>

    <p>Starts the session.</p><div><p>This function must be called before sending any headers to the client.</p></div>
    
        

    
    
    
  
    <div class="credit">
      Documentation generated by <a href="http://www.phpdoc.org">phpDocumentor 1.4.3</a>
    </div>
  </div>
  
	</div>

	<div class="footer">
	Copyright © 2010 <a href="http://apache.org">The Apache Software Foundation</a>
</div>
</div>
</body>
</html>
